<%= simple_form_for [ current_user,@restaurant ], html: {novalidate: true} do |f| %>

	<div class="col-sm-6 col-xs-12">
		<div class="col-xs-12 form-row">
			<p class='form-label'>Name</p>
			<%= f.input :name, label: false, input_html: { class: "req" }   %>
			<span class='feedback'></span>
		</div>

		<div class="col-xs-12 form-row">
			<p class='form-label'>Visible</p>
			<%= f.input :is_visible, label: false, input_html: { class: "req" },  as: :boolean   %>
			<span class='feedback'></span>
		</div>

		<div class="col-xs-12 form-row">
			<p class='form-label'>Email</p>
			<%= f.input :email, label: false, input_html: { class: "req" }  %>
			<span class='feedback'></span>
		</div>		
		<div class="col-xs-12 form-row">
			<p class='form-label'>Hours</p>
			<%= f.input :hours, label: false %>
			<span class='feedback'></span>
		</div>
		<div class="col-xs-12 form-row">
			<p class='form-label'>Phone</p>
			<%= f.input :phone, label: false %>
			<span class='feedback'></span>
		</div>
		
		<%= f.input :repos, label: false, as: :hidden %>
		<div class="col-xs-12 form-row">
			<p class='form-label'>Website</p>
			<%= f.input :website, label: false %>
			<span class='feedback'></span>
		</div>
		<div class="col-xs-12 form-row">
			<p class='form-label'>Number of Employees</p>
			<%= f.input :total_employees, label: false, input_html: { class: "req" } %>
			<span class='feedback'></span>
		</div>

		<div class="col-xs-12 form-row">
			<p class='form-label'>Description</p>
			<%= f.input :description, label: false %>
			<span class='feedback'></span>
		</div>
		<div class="col-xs-12 form-row">
			<p class='form-label'>Facebook</p>
			<%= f.input :facebook_url, label: false %>
			<span class='feedback'></span>
		</div>

		<div class="col-xs-12 form-row">
			<p class='form-label'>Cuisine</p>
			<%= f.association :cuisines, multiple: true, label:false, collection: Cuisine.all, label_method: :name, value: :id, input_html: { class: "chosen-select req", multiple: true, style: 'width:255px; height:200px;'}  %>
			<span class='feedback'></span>
		</div>
		<div class="col-xs-12 form-row">
			<p class='form-label'>Twitter</p>
			<%= f.input :twitter_url, label: false %>
			<span class='feedback'></span>
		</div>
		<div class="col-xs-12 form-row">
			<p class='form-label'>Allergy Eats</p>
			<%= f.input :allergy_eats_url, label: false %>
			<span class='feedback'></span>
		</div>
	
		<div class="col-xs-12 form-row employee">
				<h2 class="orange-header" style='text-align:left;'>Aware Employees</h2>
			<%= f.simple_fields_for :aware_employees do |builder| %>
				  <%= link_to "Delete", user_restaurant_aware_employee_path(current_user, @restaurant, builder.object.id), :method => :delete, :class => 'action' %>
				 <%= render "edit_aware_employee_fields", :f => builder %>	
				 
			<% end %>
		</div>
		<div class="col-xs-12 form-row">

			<%= link_to_add_fields "Add An Employee", f, :aware_employees %>
			<div class="sub"><p style='font-size:18px'>Submit Restaurant</p></div>
			<%= f.button :submit, :class => "nav-link", class: 'inactive submit'%>
		</div>
	</div>
	<div class="col-sm-6 col-xs-12">
		<div class="col-xs-12 form-row">
			<p class='form-label text-left'>Logo</p>
				<div class="image"><%= image_tag @restaurant.logo_url %></div>
				<%= f.file_field :logo, label: false, input_html: { class: "req" }   %>
		</div>
		<div class="col-xs-12 form-row">
			<p class='form-label text-left'>Address</p>
			<%= f.input :address, label: false, input_html: { class: "req" } %>
			<span class='feedback'></span>
		</div>
		<div class="col-xs-12 form-row">
			<p class='form-label text-left'>City</p>
			<%= f.input :city, label: false, input_html: { class: "req" } %>
			<span class='feedback'></span>
		</div>
		<div class="col-xs-12 form-row">
			<p class='form-label text-left'>State</p>
			<%= f.input :state, collection: @states, include_blank: 'Select...',required: true, label: false, input_html: { class: "chosen-select" } %>
			<span class='feedback'></span>
		</div>
		<div class="col-xs-12 form-row">
			<p class='form-label text-left'>Zip Code</p>
			<%= f.input :zip, label: false, input_html: { class: "req" } %>
			<span class='feedback'></span>
		</div>
		<div class="col-xs-12 form-row">
			<p class='form-label'>Neighborhood</p>
			<%= f.association :neighborhoods, label:false, multiple: true, collection: Neighborhood.all, label_method: :name, value: :id, input_html: { class: "chosen-select req", multiple: true, style: 'width:255px; height:200px;'}  %>
			<span class='feedback'></span><br>
			<p style='float:left; text-decoration:underline' id='check'>Check Address</p>
		</div>
		<div class="col-xs-12 form-row">		
			<div id="map-canvas" ></div>
			
		</div>
	</div>
	<div style='clear:both'></div>
	
<% end %>
<% if @restaurant.repos == '' %>
	<script>
		initialize();
		
			var address = $('#restaurant_address')[0];
			var city = $('#restaurant_city')[0];
			var state = $('#restaurant_state')[0];
			var params = $(address).val() + ',' + $(city).val() + ',' + $(state).val() ;
			var params = params.replace(/\s+/g, '+')
				if (params.length < 5) {
					alert('please provide a valid address');
				}else{
					geocode(params);
				}
		
	</script>
<%else%>
	<script>
			initialize();
			parseLoc(<%= @restaurant.repos %>);		
			$('#map-canvas').animate({opacity:1},500);
	</script>
<%end%>

<script>

$('.chosen-select').chosen();
$('input, textarea, .select').on('blur',function(){ 
	var id = $(this).attr('id');
	if ( validate_element(this) == true ){
		$("#" + id).css('border', '1px solid green');
	}else{
		$("#" + id).css('border', '1px solid red');
	}
});

$('.add_fields').on('click', function(){
	setTimeout(function(){
		$('.role-click a').trigger('click');
	}, 10)
		$('.role-click a').css('display', 'none');
		$('.role-click a').remove();
})

</script>
